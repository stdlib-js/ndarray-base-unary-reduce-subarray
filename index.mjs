// Copyright (c) 2025 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import r from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-property@v0.2.1-esm/index.mjs";import e from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-ndarraylike2object@v0.2.2-esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-to-unique-normalized-indices@esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-indices-complement@esm/index.mjs";import t from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-take-indexed2@esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-iteration-order@v0.2.2-esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-numel@v0.2.2-esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-join@v0.1.1-esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/error-tools-fmtprodmsg@v0.2.2-esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-unary-loop-interchange-order@v0.2.1-esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-unary-tiling-block-size@v0.2.2-esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-take-indexed@v0.2.2-esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-zeros@v0.2.2-esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-without@esm/index.mjs";import p from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-vind2bind@v0.2.2-esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-row-major-string@esm/index.mjs";import v from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-function@v0.2.2-esm/index.mjs";function g(r,e){var s;for(s=0;s<r.length;s++)r[s]+=e[s];return r}function j(r,e){var s,n;for(s=0,n=0;s<e.length;s++)1!==s&&(r[n].offset=e[s],n+=1);return r}function b(r){var e,s=[];for(e=0;e<r.length;e++)s.push(r[e].offset);return s}var y="throw";var x="throw";var w=[function(r,e,s){e[1].data[e[1].offset]=r(m(e,1),s)},function(r,e,s,n,t){var o,i,d,a,l,u,f;for(d=(u=e[1]).shape[0],i=[n[0]],f=1;f<e.length;f++)i.push(e[f].strides[0]);for(a=b(e),o=u.data,l=0;l<d;l++)j(s,a),o[a[1]]=r(s,t),g(a,i)},function(r,e,s,n,t){var o,i,d,a,l,u,f,h,m,p,v,y;if(a=(v=e[1]).shape,c(v.order))for(l=a[1],u=a[0],i=[n[1]],d=[n[0]-l*n[1]],y=1;y<e.length;y++)f=e[y].strides,i.push(f[1]),d.push(f[0]-l*f[1]);else for(l=a[0],u=a[1],i=[n[0]],d=[n[1]-l*n[0]],y=1;y<e.length;y++)f=e[y].strides,i.push(f[0]),d.push(f[1]-l*f[0]);for(h=b(e),o=v.data,p=0;p<u;p++){for(m=0;m<l;m++)j(s,h),o[h[1]]=r(s,t),g(h,i);g(h,d)}},function(r,e,s,n,t){var o,i,d,a,l,u,f,h,m,p,v,y,x,w,E;if(l=(w=e[1]).shape,c(w.order))for(u=l[2],f=l[1],h=l[0],i=[n[2]],d=[n[1]-u*n[2]],a=[n[0]-f*n[1]],E=1;E<e.length;E++)m=e[E].strides,i.push(m[2]),d.push(m[1]-u*m[2]),a.push(m[0]-f*m[1]);else for(u=l[0],f=l[1],h=l[2],i=[n[0]],d=[n[1]-u*n[0]],a=[n[2]-f*n[1]],E=1;E<e.length;E++)m=e[E].strides,i.push(m[0]),d.push(m[1]-u*m[0]),a.push(m[2]-f*m[1]);for(p=b(e),o=w.data,x=0;x<h;x++){for(y=0;y<f;y++){for(v=0;v<u;v++)j(s,p),o[p[1]]=r(s,t),g(p,i);g(p,d)}g(p,a)}},null,null,null,null,null,null,null],E=[function(r,e,s){var n=e[1];n.accessors[1](n.data,n.offset,r(m(e,1),s))},function(r,e,s,n,t,o){var i,d,a,l,u,f,h,m;for(l=(h=e[1]).shape[0],a=[n[0]],m=1;m<e.length;m++)a.push(e[m].strides[0]);for(u=b(e),i=h.data,d=h.accessors[1],f=0;f<l;f++)j(s,u),d(i,u[1],r(s,o)),g(u,a)},null,null,null,null,null,null,null,null,null],N=[function(r,e,s,n,t){var o,i,d,a,m,p,c,v,y,x,w,E,N,P,k,z,A,T,V,q;for(z=e.length,A=e[0],T=e[1],p=(V=l(T.shape,n,T.strides)).sh,y=[V.sx,V.sy],q=2;q<z;q++)y.push(f(e[q].strides,V.idx));for(o=u(A.dtype,T.dtype),x=b(e),i=T.data,d=[],q=0;q<z;q++)d.push(y[q][0]);for(m=h(z),a=h(z),w=h(z),k=p[1];k>0;){for(k<o?(v=k,k=0):(v=o,k-=o),q=0;q<z;q++)m[q]=x[q]+k*y[q][1];for(P=p[0];P>0;){for(P<o?(c=P,P=0):(c=o,P-=o),q=0;q<z;q++)w[q]=m[q]+P*y[q][0],a[q]=y[q][1]-c*y[q][0];for(N=0;N<v;N++){for(E=0;E<c;E++)j(s,w),i[w[1]]=r(s,t),g(w,d);g(w,a)}}}},null,null,null,null,null,null,null,null],P=[function(r,e,s,n,t){var o,i,d,a,m,p,c,v,y,x,w,E,N,P,k,z,A,T,V,q,I;for(A=e.length,T=e[0],V=e[1],c=(q=l(V.shape,n,V.strides)).sh,x=[q.sx,q.sy],I=2;I<A;I++)x.push(f(e[I].strides,q.idx));for(o=u(T.dtype,V.dtype),w=b(e),i=V.data,d=V.accessors[1],a=[],I=0;I<A;I++)a.push(x[I][0]);for(p=h(A),m=h(A),E=h(A),z=c[1];z>0;){for(z<o?(y=z,z=0):(y=o,z-=o),I=0;I<A;I++)p[I]=w[I]+z*x[I][1];for(k=c[0];k>0;){for(k<o?(v=k,k=0):(v=o,k-=o),I=0;I<A;I++)E[I]=p[I]+k*x[I][0],m[I]=x[I][1]-v*x[I][0];for(P=0;P<y;P++){for(N=0;N<v;N++)j(s,E),d(i,E[1],r(s,t)),g(E,a);g(E,m)}}}},null,null,null,null,null,null,null,null],k=w.length-1;function z(r,l,u,f){var m,c,v,g,z,A,T,V,q,I,R,B,C,D,F,G,H,J,K,L,M,O,Q,S,U;for(g=arguments.length>3?f:{},K=l.length,z=[],S=0;S<K;S++)z.push(e(l[S]));if(O=z[0],Q=z[1],c=(V=O.shape).length,L=u.length,null===(H=s(u,c)))throw new RangeError(a("invalid argument. Third argument contains an out-of-bounds dimension index. Value: [%s].",d(u,",")));if(H.sort(),H.length!==L)throw new Error(a("invalid argument. Third argument must contain a list of unique dimension indices. Value: [%s].",d(u,",")));if(L>c)throw new RangeError(a("invalid argument. Number of specified dimensions cannot exceed the number of dimensions in the input array. Number of dimensions: %d. Value: [%s].",c,d(u,",")));for(M=c-L,S=1;S<K;S++)if(z[S].shape.length!==M)throw new Error(a("invalid argument. Arrays which are not being reduced must have the same number of non-reduced dimensions. Input array shape: [%s]. Number of non-reduced dimensions: %d. Array shape: [%s] (index: %d).",d(V,","),M,d(z[S].shape,","),S));if(0===M)return Q.accessorProtocol?E[M](r,z,g):w[M](r,z,g);for(v=n(V.length,H),I=(A=t(V,O.strides,v))[0],D=A[1],q=(A=t(V,O.strides,H))[0],C=A[1],T=1,G=0,S=0;S<M;S++){for(J=I[S],U=1;U<K;U++)if(J!==z[U].shape[S])throw new Error(a("invalid argument. Non-reduced dimensions must be consistent across all provided arrays. Input array shape: [%s]. Non-reduced dimension indices: [%s]. Non-reduced dimensions: [%s]. Array shape: [%s] (index: %d).",d(V,","),d(v,","),d(I,","),d(z[U].shape,","),U));T*=J,1===J&&(G+=1)}if(!(0===T||q.length&&0===i(q))){if(function(r,e){var s,n;for(n=2;n<r.length;n++)s=r[n],e.push({dtype:s.dtype,data:s.data,shape:[],strides:[0],offset:s.offset,order:s.order})}(z,m=[{dtype:O.dtype,data:O.data,shape:q,strides:C,offset:O.offset,order:O.order}]),1===M)return Q.accessorProtocol?E[M](r,z,m,D,g):w[M](r,z,m,D,g);if(F=Q.strides,G===M-1){for(S=0;S<M&&1===I[S];S++);for(Q.shape=[I[S]],U=0;U<K;U++)z[U].strides=[z[U].strides[S]];return D=[D[S]],Q.accessorProtocol?E[1](r,z,m,D,g):w[1](r,z,m,D,g)}return R=o(D),B=o(F),0!==R&&0!==B&&R===B&&M<=k?Q.accessorProtocol?E[M](r,z,m,D,g):w[M](r,z,m,D,g):M<=k?Q.accessorProtocol?P[M-2](r,z,m,D,g):N[M-2](r,z,m,D,g):Q.accessorProtocol?function(r,e,s,n,t){var o,d,a,l,u,f,m,c,v,g,x;for(m=e.length,l=(v=e[1]).shape,d=i(l),u=b(e),o=v.data,a=v.accessors[1],f=h(m),g=0;g<d;g++){for(x=0;x<m;x++)c=e[x],f[x]=p(l,c.strides,u[x],c.order,g,y);j(s,f),a(o,f[1],r(s,t))}}(r,z,m,0,g):void function(r,e,s,n,t){var o,d,a,l,u,f,m,c,v,g;for(f=e.length,a=(c=e[1]).shape,d=i(a),l=b(e),o=c.data,u=h(f),v=0;v<d;v++){for(g=0;g<f;g++)m=e[g],u[g]=p(a,m.strides,l[g],m.order,v,x);j(s,u),o[u[1]]=r(s,t)}}(r,z,m,0,g)}}function A(r){if(!v(r))throw new TypeError(a("null3c",r));return function(e,s,n){var t;t=arguments.length>2?n:{};return z(r,e,s,t)}}r(z,"factory",A);export{z as default,A as factory};
//# sourceMappingURL=index.mjs.map
