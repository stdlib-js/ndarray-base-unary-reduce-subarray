// Copyright (c) 2025 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import r from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-property@v0.2.1-esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-ndarraylike2object@v0.2.2-esm/index.mjs";import e from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-to-unique-normalized-indices@esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-indices-complement@esm/index.mjs";import t from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-take-indexed2@esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-iteration-order@v0.2.2-esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-numel@v0.2.2-esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-join@v0.1.1-esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/error-tools-fmtprodmsg@v0.2.2-esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-unary-loop-interchange-order@v0.2.1-esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-unary-tiling-block-size@v0.2.2-esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-take-indexed@v0.2.2-esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-zeros@v0.2.2-esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-without@esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-vind2bind@v0.2.2-esm/index.mjs";import p from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-row-major-string@esm/index.mjs";import g from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-function@v0.2.2-esm/index.mjs";function v(r,s){var e;for(e=0;e<r.length;e++)r[e]+=s[e];return r}function j(r,s){var e,n;for(e=0,n=0;e<s.length;e++)1!==e&&(r[n].offset=s[n],n+=1);return r}function b(r){var s,e=[];for(s=0;s<r.length;s++)e.push(r[s].offset);return e}var y="throw";var x="throw";var w=[function(r,s,e){s[1].data[s[1].offset]=r(c(s,1),e)},function(r,s,e,n,t){var o,i,d,a,l,u,f;for(d=(u=s[1]).shape[0],i=[n[0]],f=1;f<s.length;f++)i.push(s[f].strides[0]);for(a=b(s),o=u.data,l=0;l<d;l++)j(e,a),o[a[1]]=r(e,t),v(a,i)},function(r,s,e,n,t){var o,i,d,a,l,u,f,h,c,m,g,y;if(a=(g=s[1]).shape,p(g.order))for(l=a[1],u=a[0],i=[n[1]],d=[n[0]-l*n[1]],y=1;y<s.length;y++)f=s[y].strides,i.push(f[1]),d.push(f[0]-l*f[1]);else for(l=a[0],u=a[1],i=[n[0]],d=[n[1]-l*n[0]],y=1;y<s.length;y++)f=s[y].strides,i.push(f[0]),d.push(f[1]-l*f[0]);for(h=b(s),o=g.data,m=0;m<u;m++){for(c=0;c<l;c++)j(e,h),o[h[1]]=r(e,t),v(h,i);v(h,d)}},function(r,s,e,n,t){var o,i,d,a,l,u,f,h,c,m,g,y,x,w,P;if(l=(w=s[1]).shape,p(w.order))for(u=l[2],f=l[1],h=l[0],i=[n[2]],d=[n[1]-u*n[2]],a=[n[0]-f*n[1]],P=1;P<s.length;P++)c=s[P].strides,i.push(c[2]),d.push(c[1]-u*c[2]),a.push(c[0]-f*c[1]);else for(u=l[0],f=l[1],h=l[2],i=[n[0]],d=[n[1]-u*n[0]],a=[n[2]-f*n[1]],P=1;P<s.length;P++)c=s[P].strides,i.push(c[0]),d.push(c[1]-u*c[0]),a.push(c[2]-f*c[1]);for(m=b(s),o=w.data,x=0;x<h;x++){for(y=0;y<f;y++){for(g=0;g<u;g++)j(e,m),o[m[1]]=r(e,t),v(m,i);v(m,d)}v(m,a)}},null,null,null,null,null,null,null],P=[function(r,s,e){var n=s[1];n.accessors[1](n.data,n.offset,r(c(s,1),e))},function(r,s,e,n,t,o){var i,d,a,l,u,f,h,c;for(l=(h=s[1]).shape[0],a=[n[0]],c=1;c<s.length;c++)a.push(s[c].strides[0]);for(u=b(s),i=h.data,d=h.accessors[1],f=0;f<l;f++)j(e,u),d(i,u[1],r(e,o)),v(u,a)},null,null,null,null,null,null,null,null,null],E=[function(r,s,e,n,t){var o,i,d,a,c,m,p,g,y,x,w,P,E,N,k,z,T,V,q,A;for(z=s.length,T=s[0],V=s[1],m=(q=l(V.shape,n,V.strides)).sh,y=[q.sx,q.sy],A=2;A<z;A++)y.push(f(s[A].strides,q.idx));for(o=u(T.dtype,V.dtype),x=b(s),i=V.data,d=[],A=0;A<z;A++)d.push(y[A][0]);for(c=h(z),a=h(z),w=h(z),k=m[1];k>0;){for(k<o?(g=k,k=0):(g=o,k-=o),A=0;A<z;A++)c[A]=x[A]+k*y[A][1];for(N=m[0];N>0;){for(N<o?(p=N,N=0):(p=o,N-=o),A=0;A<z;A++)w[A]=c[A]+N*y[A][0],a[A]=y[A][1]-p*y[A][0];for(E=0;E<g;E++){for(P=0;P<p;P++)j(e,w),i[w[1]]=r(e,t),v(w,d);v(w,a)}}}},null,null,null,null,null,null,null,null],N=[function(r,s,e,n,t){var o,i,d,a,c,m,p,g,y,x,w,P,E,N,k,z,T,V,q,A,R;for(T=s.length,V=s[0],q=s[1],p=(A=l(q.shape,n,q.strides)).sh,x=[A.sx,A.sy],R=2;R<T;R++)x.push(f(s[R].strides,A.idx));for(o=u(V.dtype,q.dtype),w=b(s),i=q.data,d=q.accessors[1],a=[],R=0;R<T;R++)a.push(x[R][0]);for(m=h(T),c=h(T),P=h(T),z=p[1];z>0;){for(z<o?(y=z,z=0):(y=o,z-=o),R=0;R<T;R++)m[R]=w[R]+z*x[R][1];for(k=p[0];k>0;){for(k<o?(g=k,k=0):(g=o,k-=o),R=0;R<T;R++)P[R]=m[R]+k*x[R][0],c[R]=x[R][1]-g*x[R][0];for(N=0;N<y;N++){for(E=0;E<g;E++)j(e,P),d(i,P[1],r(e,t)),v(P,a);v(P,c)}}}},null,null,null,null,null,null,null,null],k=w.length-1;function z(r,l,u,f){var c,p,g,v,z,T,V,q,A,R,I,B,C,D,F,G,H,J,K,L,M,O,Q,S,U;for(v=arguments.length>3?f:{},K=l.length,z=[],S=0;S<K;S++)z.push(s(l[S]));if(O=z[0],Q=z[1],p=(q=O.shape).length,L=u.length,null===(H=e(u,p)))throw new RangeError(a("invalid argument. Third argument contains an out-of-bounds dimension index. Value: [%s].",d(u,",")));if(H.sort(),H.length!==L)throw new Error(a("invalid argument. Third argument must contain a list of unique dimension indices. Value: [%s].",d(u,",")));if(L>p)throw new RangeError(a("invalid argument. Number of specified dimensions cannot exceed the number of dimensions in the input array. ndims(x) == %d. Value: [%s].",p,d(u,",")));for(M=p-L,S=1;S<K;S++)if(z[S].shape.length!==M)throw new Error(a("invalid argument. Arrays which are not being reduced must have the same number of non-reduced dimensions. ndims(x) == %d. Number of reduced dimensions: %d. ndims(arrays[%d]) == %d.",p,L,S,z[S].shape.length));if(0===M)return O.accessorProtocol||Q.accessorProtocol?P[M](r,z,v):w[M](r,z,v);for(g=n(q.length,H),R=(T=t(q,O.strides,g))[0],D=T[1],A=(T=t(q,O.strides,H))[0],C=T[1],V=1,G=0,S=0;S<M;S++){for(J=R[S],U=1;U<K;U++)if(J!==z[U].shape[S])throw new Error(a("invalid argument. Non-reduced dimensions must be consistent across all provided arrays. Input array shape: [%s]. Non-reduced dimension indices: [%s]. Non-reduced dimensions: [%s]. Array shape: [%s] (index: %d).",d(q,","),d(g,","),d(R,","),d(z[U].shape,","),U));V*=J,1===J&&(G+=1)}if(!(0===V||A.length&&0===i(A))){if(function(r,s){var e,n;for(n=2;n<r.length;n++)e=r[n],s.push({dtype:e.dtype,data:e.data,shape:[],strides:[0],offset:e.offset,order:e.order})}(z,c=[{dtype:O.dtype,data:O.data,shape:A,strides:C,offset:O.offset,order:O.order}]),1===M)return O.accessorProtocol||Q.accessorProtocol?P[M](r,z,c,D,v):w[M](r,z,c,D,v);if(F=Q.strides,G===M-1){for(S=0;S<M&&1===R[S];S++);for(Q.shape=[R[S]],U=0;U<K;U++)z[U].strides=[z[U].strides[S]];return D=[D[S]],O.accessorProtocol||Q.accessorProtocol?P[1](r,z,c,D,v):w[1](r,z,c,D,v)}return I=o(D),B=o(F),0!==I&&0!==B&&I===B&&M<=k?O.accessorProtocol||Q.accessorProtocol?P[M](r,z,c,D,v):w[M](r,z,c,D,v):M<=k?O.accessorProtocol||Q.accessorProtocol?N[M-2](r,z,c,D,v):E[M-2](r,z,c,D,v):O.accessorProtocol||Q.accessorProtocol?function(r,s,e,n,t){var o,d,a,l,u,f,c,p,g,v,x;for(c=s.length,l=(g=s[1]).shape,d=i(l),u=b(s),o=g.data,a=g.accessors[1],f=h(c),v=0;v<d;v++){for(x=0;x<c;x++)p=s[x],f[x]=m(l,p.strides,u[x],p.order,v,y);j(e,f),a(o,f[1],r(e,t))}}(r,z,c,0,v):void function(r,s,e,n,t){var o,d,a,l,u,f,c,p,g,v;for(f=s.length,a=(p=s[1]).shape,d=i(a),l=b(s),o=p.data,u=h(f),g=0;g<d;g++){for(v=0;v<f;v++)c=s[v],u[v]=m(a,c.strides,l[v],c.order,g,x);j(e,u),o[u[1]]=r(e,t)}}(r,z,c,0,v)}}function T(r){if(!g(r))throw new TypeError(a("null3c",r));return function(s,e,n){var t;t=arguments.length>2?n:{};return z(r,s,e,t)}}r(z,"factory",T);export{z as default,T as factory};
//# sourceMappingURL=index.mjs.map
